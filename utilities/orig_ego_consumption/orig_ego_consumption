------------
-- Table set up for German electricity consumption in 2011 based on http://www.lak‐energiebilanzen.de/seiten/energiebilanzenLaender.cfm 
------------


-- CREATE TABLE orig_ego_consumption.lak_consumption_per_federalstate 
-- ( 
--   eu_code character varying(7) NOT NULL, 
--   federal_states character varying NOT NULL, 
--   elec_consumption_households double precision NOT NULL, 
--   elec_consumption_industry double precision NOT NULL, 
--   elec_consumption_tertiary_sector double precision NOT NULL, ‐‐ Commercial, trading, public buildings etc. 
-- PRIMARY KEY (eu_code) 
-- ) 
-- ; 

UPDATE orig_ego_consumption.lak_consumption_per_federalstate
SET eu_code = RPAD(eu_code::text, 5, '0') -- Zero-pads to the right up to the length of 5;


COMMENT ON TABLE  orig_ego_consumption.lak_consumption_per_federalstate IS
'{
"Name": "Electricity consumption per federal state in Germany",
"Source": [{
                  "Name": "Länderarbeitskreis Energiebilanzen",
                  "URL":  "http://www.lak-energiebilanzen.de/seiten/energiebilanzenLaender.cfm" }, 
		{
                  "Name": "Statistisches Landesamt Baden-Württemberg",
                  "URL":  "http://www.lak-energiebilanzen.de/seiten/download/Archiv%20Bilanzen/Baden-W%C3%BCrttemberg/2011/Energiebilanz%20BadenW%C3%BCrttemberg2011.pdf" }, 
		{
                  "Name": "Amt für Statistik Berlin-Brandenburg",
                  "URL":  "http://www.lak-energiebilanzen.de/seiten/download/Archiv%20Bilanzen/Berlin/2011/Energiebilanz%20Berlin%202011.pdf" }, 
		{
                  "Name": "Amt für Statistik Berlin-Brandenburg",
                  "URL":  "http://www.lak-energiebilanzen.de/seiten/download/Archiv%20Bilanzen/Brandenburg/2011/Energiebilanz%20Brandenburg%202011.pdf" }, 
		{
                  "Name": "Statistisches Landesamt Bremen",
                  "URL":  "http://www.lak-energiebilanzen.de/seiten/download/Archiv%20Bilanzen/Bremen/2011/Energiebilanz%20Bremen%202011.pdf" },
		{
                  "Name": "Statistisches Amt für Hamburg und Schleswig-Holstein",
                  "URL":  "www.lak-energiebilanzen.de/seiten/download/Archiv Bilanzen/Hamburg/2011/Energiebilanz Hamburg 2011.pdf" },
		{
                  "Name": "Statistisches Amt für Hamburg und Schleswig-Holstein",
                  "URL":  "http://www.lak-energiebilanzen.de/seiten/download/Archiv%20Bilanzen/Schleswig-Holstein/2011/Energiebilanz%20SchleswigHolstein%202011.pdf" },
		{
                  "Name": "Statistisches Landesamt Rheinland-Pfalz",
                  "URL":  "http://www.lak-energiebilanzen.de/seiten/download/Archiv%20Bilanzen/Rheinland-Pfalz/2011/Energiebilanz%20RheinlandPfalz%202011.pdf" },
		{
                  "Name": "Statistisches Amt Saarland",
                  "URL":  "http://www.lak-energiebilanzen.de/seiten/download/Archiv%20Bilanzen/Saarland/2011/Energiebilanz%20Saarland%202011.pdf" },
		{
                  "Name": "Statistisches Landesamt Sachsen",
                  "URL":  "http://www.lak-energiebilanzen.de/seiten/download/Archiv%20Bilanzen/Sachsen/2011/Energiebilanz%20Sachsen%202011.pdf" },
		{
                  "Name": "Bayerisches Landesamt für Statistik und Datenverarbeitung",
                  "URL":  "http://www.stmwi.bayern.de/fileadmin/user_upload/stmwivt/Themen/Energie_und_Rohstoffe/Dokumente_und_Cover/Energiebilanz/2014/B-03_bilanzjo_mgh_2014-03-07.pdf" }, 
		{
                  "Name": "Hessisches Statistisches Landesamt",
                  "URL":  "http://www.statistik-hessen.de/publikationen/download/277/index.html" }, 
		{
                  "Name": "Statistisches Amt Mecklenburg-Vorpommern",
                  "URL":  "https://www.destatis.de/GPStatistik/servlets/MCRFileNodeServlet/MVHeft_derivate_00000168/E453_2011_00a.pdf;jsessionid=CD300CD3A06FF85FDEA864FF4D91D880" }, 
		{
                  "Name": "Niedersächsisches Ministerium für Umwelt, Energie und Klimaschutz",
                  "URL":  "http://www.umwelt.niedersachsen.de/energie/daten/co2bilanzen/niedersaechsische-energie--und-co2-bilanzen-2009-6900.html" }, 
		{
                  "Name": "Information und Technik Nordrhein-Westfalen",
                  "URL":  "https://webshop.it.nrw.de/gratis/E449%20201100.pdf" }, 
		{
                  "Name": "Statistisches Landesamt Sachsen-Anhalt",
                  "URL":  "http://www.stala.sachsen-anhalt.de/download/stat_berichte/6E402_j_2011.pdf" }, 
		{
                  "Name": "Thüringer Landesamt für Statistik",
                  "URL":  "http://www.statistik.thueringen.de/webshop/pdf/2011/05402_2011_00.pdf" },
		{
                  "Name": "Statistisches Bundesamt, Wiesbaden, Genesis-Online, Datenlizenz by-2-0.",
                  "URL":  "https://ergebnisse.zensus2011.de/" }],

"Reference date": "2011",
"Date of collection": "November 2015",
"Original file": "...",
"Spatial resolution": ["Germany"],
"Description": ["Electricity consumption of the sectors households, industry and tertiary sector (including others) for the German federal states in 2011"],
"Column": [
                   {"Name": "eu_code",
                    "Description": "Nuts code for federal state",
                    "Unit": "" },
                   {"Name": "federal_states",
                    "Description": "Name of federal state in Germany",
                    "Unit": "" },
                   {"Name": "elec_consumption_housholds",
                    "Description": "Annual electricity consumption in the household sector",
                    "Unit": "GWh" },
                   {"Name": "elec_consumption_industry",
                    "Description": "Annual electricity consumption in the industrial sector",
                    "Unit": "GWh" },
                   {"Name": "elec_consumption_tertiary_sector",
                    "Description": "Annual electricity consumption in the tertiary sector including public sector",
                    "Unit": "GWh" },
                   {"Name": "population",
                    "Description": "Inhabitants per federal state",
                    "Unit": "" },
                   {"Name": "elec_consumption_households_per_person",
                    "Description": "Electricity consumption of household sector per inhabitant",
                    "Unit": "GWh" }],
"Changes":[
                   {"Name": "Ilka Cussmann",
                    "Mail": "ilka.cussmann@hs-flensburg.de",
                    "Date":  "24.10.2016",
                    "Comment": "Add json-string" }
                  ],
"ToDo": ["Add licence"],
"Licence": [""],
"Instructions for proper use": [""]
}';

SELECT obj_description('orig_ego_consumption.lak_consumption_per_federalstate'::regclass)::json;

-------------
-- Table set up for gross value added per German districts (Landkreise) in 2011 based on 
-- https://www.destatis.de/DE/Publikationen/Thematisch/VolkswirtschaftlicheGesamtrechnungen/VGRderLaender/VGR_KreisergebnisseBand1.html 
-------------

-- CREATE TABLE orig_ego_consumption.destatis_gva_per_districts
-- ( 
--   eu_code character varying(7) NOT NULL, 
--   district character varying NOT NULL, 
--   total_gva double precision NOT NULL, 
--   gva_industry double precision NOT NULL, 
--   gva_tertiary_sector double precision NOT NULL, ‐‐ Commercial, trading, public buildings etc. 
-- PRIMARY KEY (eu_code) 
-- ) 
-- ;

COMMENT ON TABLE  orig_ego_consumption.destatis_gva_per_districts IS
'{
"Name": "Gross value added per district in Germany",
"Source": [{
                  "Name": "Statistisches Bundesamt (Destatis)- VGR der Länder",
                  "URL":  "https://www.destatis.de/DE/Publikationen/Thematisch/VolkswirtschaftlicheGesamtrechnungen/VGRderLaender/VGR_KreisergebnisseBand1.html" }],
"Reference date": "2011",
"Date of collection": "15.12.2015",
"Original file": "VGR_KreisergebnisseBand1_5820009117005.xls",
"Spatial resolution": ["Germany"],
"Description": ["Gross value added per administrative district for the business sectors industry and tertiary sector"],
"Column": [
                   {"Name": "eu_code",
                    "Description": "nuts id for district",
                    "Unit": "" },
                   {"Name": "district",
                    "Description": "district name",
                    "Unit": "" },
                   {"Name": "total_gva",
                    "Description": "total gross value added per district",
                    "Unit": "Million Euro" },
                   {"Name": "gva_industry",
                    "Description": "gross value added of industry per district",
                    "Unit": "Mullion Euro" },
                   {"Name": "gva_tertiary_sector",
                    "Description": "gross value added of tertiary sector per district",
                    "Unit": "Million Euro" }],
"Changes":[
                   {"Name": "Mario Kropshofer",
                    "Mail": "mario.kropshofer2@stud.fh-flensburg.de",
                    "Date":  "05.10.2016",
                    "Comment": "..." }, 
                    
                   {"Name": "Ilka Cussmann",
                    "Mail": "ilka.cussmann@hs-flensburg.de",
                    "Date":  "25.10.2016",
                    "Comment": "Completed json-string" }
                    
                  ],
"ToDo": [""],
"Licence": ["unspecified licence"],
"Instructions for proper use": ["Reproduction and distribution, also of parts, are permitted provided that the source is mentioned. © Statistisches Landesamt Baden-Württemberg, Stuttgart, 2015"]
}';


SELECT obj_description('orig_ego_consumption.destatis_gva_per_districts'::regclass)::json;


UPDATE orig_ego_consumption.destatis_gva_per_districts
SET eu_code = RPAD(eu_code::text, 5, '0') -- Zero-pads to the right up to the length of 5;


-- The eu_code of some grid districts are inconsistent between orig_ego_consumption.destatis_gva_per_districts
-- and orig_vg250.vg250_4_krs. Therefore some eu_code are renamed in this table to achieve consistency. 

UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80J'
	WHERE eu_code = 'DE805';


UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80K'
	WHERE eu_code = 'DE806';

UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80L'
	WHERE eu_code = 'DE807';


UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80M'
	WHERE eu_code = 'DE808';


UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80N'
	WHERE eu_code = 'DE809';

UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80O'
	WHERE eu_code = 'DE80A';
 



