------------
-- Table set up for German electricity consumption in 2011 based on http://www.lak‐energiebilanzen.de/seiten/energiebilanzenLaender.cfm 
------------


-- CREATE TABLE orig_ego_consumption.lak_consumption_per_federalstate 
-- ( 
--   eu_code character varying(7) NOT NULL, 
--   federal_states character varying NOT NULL, 
--   elec_consumption_households double precision NOT NULL, 
--   elec_consumption_industry double precision NOT NULL, 
--   elec_consumption_tertiary_sector double precision NOT NULL, ‐‐ Commercial, trading, public buildings etc. 
-- PRIMARY KEY (eu_code) 
-- ) 
-- ; 

UPDATE orig_ego_consumption.lak_consumption_per_federalstate
SET eu_code = RPAD(eu_code::text, 5, '0') -- Zero-pads to the right up to the length of 5;


COMMENT ON TABLE  orig_ego_consumption.lak_consumption_per_federalstate IS
'{
"Name": "Electricity consumption per federal state in Germany",
"Source": [{
                  "Name": "Länderarbeitskreis Energiebilanzen",
                  "URL":  "http://www.lak-energiebilanzen.de/seiten/energiebilanzenLaender.cfm" }],
"Reference date": "2011",
"Date of collection": "November 2015",
"Original file": "...",
"Spatial resolution": ["Germany"],
"Description": ["..."],
"Column": [
                   {"Name": "eu_code",
                    "Description": "Nuts code for federal state",
                    "Unit": "" },
                   {"Name": "federal_states",
                    "Description": "Name of federal state in Germany",
                    "Unit": "" },
                   {"Name": "elec_consumption_housholds",
                    "Description": "Annual electricity consumption in the household sector",
                    "Unit": "GWh" },
                   {"Name": "elec_consumption_industry",
                    "Description": "Annual electricity consumption in the industrial sector",
                    "Unit": "GWh" },
                   {"Name": "elec_consumption_tertiary_sector",
                    "Description": "Annual electricity consumption in the tertiary sector including public sector",
                    "Unit": "GWh" },
                   {"Name": "population",
                    "Description": "Inhabitants per federal state",
                    "Unit": "" },
                   {"Name": "elec_consumption_households_per_person",
                    "Description": "Electricity consumption of household sector per inhabitant",
                    "Unit": "GWh" }],
"Changes":[
                   {"Name": "Ilka Cussmann",
                    "Mail": "ilka.cussmann@hs-flensburg.de",
                    "Date":  "24.10.2016",
                    "Comment": "..." }
                  ],
"ToDo": [""],
"Licence": ["..."],
"Instructions for proper use": ["..."]
}';



-------------
-- Table set up for gross value added per German districts (Landkreise) in 2011 based on 
-- https://www.destatis.de/DE/Publikationen/Thematisch/VolkswirtschaftlicheGesamtrechnungen/VGRderLaender/VGR_KreisergebnisseBand1.html 
-------------

-- CREATE TABLE orig_ego_consumption.destatis_gva_per_districts
-- ( 
--   eu_code character varying(7) NOT NULL, 
--   district character varying NOT NULL, 
--   total_gva double precision NOT NULL, 
--   gva_industry double precision NOT NULL, 
--   gva_tertiary_sector double precision NOT NULL, ‐‐ Commercial, trading, public buildings etc. 
-- PRIMARY KEY (eu_code) 
-- ) 
-- ;

UPDATE orig_ego_consumption.destatis_gva_per_districts
SET eu_code = RPAD(eu_code::text, 5, '0') -- Zero-pads to the right up to the length of 5;


-- The eu_code of some grid districts are inconsistent between orig_ego_consumption.destatis_gva_per_districts
-- and orig_vg250.vg250_4_krs. Therefore some eu_code are renamed in this table to achieve consistency. 

UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80J'
	WHERE eu_code = 'DE805';


UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80K'
	WHERE eu_code = 'DE806';

UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80L'
	WHERE eu_code = 'DE807';


UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80M'
	WHERE eu_code = 'DE808';


UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80N'
	WHERE eu_code = 'DE809';

UPDATE orig_ego_consumption.destatis_gva_per_districts
	SET eu_code = 'DE80O'
	WHERE eu_code = 'DE80A';
 



